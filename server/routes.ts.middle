      // Add additional context for better user experience
      const enhancedResponse = {
        merchantName: data.merchantName || data.merchant || "Unknown Merchant",
        date: data.date || new Date().toISOString().split('T')[0],
        items: data.items || [],
        total: data.total || data.totalAmount || 0,
        currency: data.currency || "USD", 
        category: suggestedCategory, // Add suggested category for the receipt
        processingMethod: "gpt-4o with enhanced categorization",
        detectionConfidence: "high"
      };
      
      res.json(enhancedResponse);
  } catch (error) {
    console.error("Error processing receipt image:", error);
    res.status(500).json({ 
      message: "Failed to process receipt image", 
      error: error instanceof Error ? error.message : "Unknown error" 
    });
  }
});