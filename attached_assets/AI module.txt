## Smart Ledger - AI Financial Insights Module Implementation Guide (LLM-Centric)

---

### ğŸ“Œ Objective

Build an AI-powered analytics module for "Smart Ledger" that delivers high-value insights using GPT and supporting APIs. The system must assist users in smart financial decision-making through:

- Categorization
- Budget tracking
- Spending insights
- Recurring detection
- Savings suggestions
- Digest reports

**Target:** Designed for implementation using GPT or Claude (without human developers), this document serves as a complete build spec with workflows, prompts, schema updates, and UX descriptions.

---

### âœ… Features Covered

1. Smart Categorization
2. Budget Tracking & Alerts
3. Recurring Expense Detection
4. Savings Suggestions
5. Weekly Smart Digest
6. Real-Time Purchase Insight

---

## âœ… Feature 1: Smart Categorization

### ğŸ¯ Purpose

Automatically assign categories (e.g., groceries, dining, utilities) to items extracted from receipt OCR.

### ğŸ§  GPT Prompt Example

```json
{"prompt": "Categorize: 'Kellogg's Chocos 375g' into one of these: groceries, dining, utilities, travel, personal care."}
```

### ğŸ§­ User Flow

1. OCR extracts items â†’ trigger categorization
2. GPT assigns each item a category
3. System saves it to DB
4. Category is shown as label/chip in UI

### âš™ï¸ Backend Logic

- On receipt upload, categorize all items
- Add `category` field to each item object

#### MongoDB Schema (Receipt Model Update)

```js
items: [
  {
    name: String,
    price: Number,
    category: String // e.g., groceries
  }
]
```

---

## âœ… Feature 2: Budget Tracking & Alerts

### ğŸ¯ Purpose

Allow users to set monthly budgets per category and get alerts when nearing/exceeding those budgets.

### ğŸ‘¥ User Actions

- Add/edit budgets per category
- View total spend vs budget
- Get notification when near limit

### ğŸ§­ User Flow

1. User configures budgets per category
2. Each new expense adds to monthly total
3. If total > 80% of budget â†’ warning alert
4. If > 100% â†’ critical alert

#### MongoDB Schema (New `budgetConfig` model)

```js
userId: ObjectId,
category: String,
limit: Number,
month: String // e.g., '2025-04'
```

#### Alert Conditions

```js
if (totalSpend >= 0.8 * limit) â†’ warn
if (totalSpend >= limit) â†’ alert
```

---

## âœ… Feature 3: Recurring Expense Detection

### ğŸ¯ Purpose

Automatically detect repeated purchases (e.g., monthly Netflix, groceries) and offer optimization suggestions.

### ğŸ§  GPT Prompt Example

```json
{"prompt": "Is this item likely recurring? 'Netflix Subscription â‚¹499'"}
```

### ğŸ§­ Logic Flow

1. Search for same item bought â‰¥2 times in 30 days
2. Mark item as `recurring: true`
3. UI can display suggestion: â€œThis item is recurring. Consider annual plan to save.â€

#### Schema Update (Receipt Model)

```js
recurring: Boolean // flag at item level
```

#### Cron Job

- Run daily
- Check receipts for repeat items
- Set `recurring = true` if condition met

---

## âœ… Feature 4: Savings Suggestions

### ğŸ¯ Purpose

Identify cheaper alternatives or bulk-buy suggestions for previously bought items.

### ğŸ§  GPT Prompt Example

```json
{"prompt": "Suggest cheaper or bulk alternative for: 'Surf Excel Matic 2kg â‚¹498'"}
```

### ğŸ§­ User Flow

1. Post-OCR â†’ compare item price with market
2. If savings found â†’ GPT crafts suggestion
3. Display below item in receipt detail or savings tab

#### Example Output

â€œYou paid â‚¹498 for Surf Excel. Buying a 4kg pack at â‚¹900 saves â‚¹96.â€

### ğŸ” Source Data

- Use mock price DB or scraping tools
- Optionally use `PriceBefore`, `ScrapeHero`, or cached Flipkart/Amazon data

---

## âœ… Feature 5: Weekly Smart Digest

### ğŸ¯ Purpose

Provide a weekly summary of userâ€™s financial activity with actionable insights.

### ğŸ§­ Digest Content

- Total spend
- Overspent categories
- Top 3 expenses
- Missed savings (sum of `gptInsight` deltas)
- Tip of the week (from GPT)

### ğŸ§  GPT Prompt Example

```json
{"prompt": "Summarize this weekâ€™s spend pattern and give 1 saving tip."}
```

### ğŸ•’ Cron Job (Every Sunday 6PM)

- Aggregate user receipts from the past 7 days
- Summarize and send digest

#### Email Content Example

```
ğŸ§¾ Weekly Spend: â‚¹9,800
ğŸ“Š Overspent in: Dining (â‚¹2,300/â‚¹2,000)
ğŸ’¸ You missed savings worth â‚¹315
ğŸ’¡ Tip: Consider preparing meals 2x per week to reduce dining cost.
```

---

## âœ… Feature 6: Real-Time Purchase Insight

### ğŸ¯ Purpose

Automatically analyze a new receipt post-OCR and provide a smart purchase insight, such as price comparison and better buying suggestions.

### ğŸ§  GPT Prompt Example

```json
{"prompt": "Analyze this item: 'Surf Excel Matic 2kg - â‚¹498', and compare with online prices. Return savings insight if possible."}
```

### ğŸ§­ User Flow

1. User uploads receipt â†’ OCR extracts items
2. System sends GPT prompt per item (or batch)
3. GPT returns insight
4. UI displays insight below item

#### Conditions:

- Max 100 GPT calls/min â†’ batch items or defer
-
  > 20 receipts queued â†’ cron job handles next batch

### ğŸ–¼ï¸ UI Description

- Show smart tag below each item
- Collapse summary for 3+ savings: â€œYou missed â‚¹135 in savings on this receiptâ€

### âš™ï¸ Backend Logic

#### MongoDB Schema Update (Receipt Model)

```js
items: [
  {
    name: String,
    price: Number,
    gptInsight: String,
    category: String,
    recurring: Boolean
  }
]
```

#### New Service

- `generateInsightsForReceipt(receiptId)`
- Call GPT for each item
- Save insight back

### ğŸ•’ Cron Job (Every 4 hours)

- Job: `processPendingReceipts`
- Find receipts with `items[].gptInsight = null`
- Retry GPT-based insight generation

### ğŸ”Œ Free APIs for Price Comparison

- [PriceBefore](https://www.pricebefore.com/)
- [WebScrapingAPI](https://www.webscrapingapi.com/)
- Flipkart/Amazon scraping (static prices)

---

## ğŸ“© Next Steps

- Generate wireframes or flowcharts for each feature
- Build UI components based on these specs
- Upload this doc to GPT/Claude for implementation

---

